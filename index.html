<!DOCTYPE html>
<!-- MIT License
Copyright (c) 2025-2026 masaru-ster

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE. -->
<html><head>
  <meta charset="UTF-8">
  <title>MSR式箱庭ゲーム　Ver.4.6</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div id="gameControls" style="margin-bottom: 1em;">
  <label for="islandNameInput">島の名前:</label>
  <input type="text" id="islandNameInput" value="MyIsland">
  <button onclick="saveGame()">セーブ</button>
  <button onclick="loadGame()">ロード</button>
  <textarea id="saveLoadData" rows="5" cols="60" placeholder="ここにセーブデータが表示されます。ロードする際はここにデータを貼り付けてください。" style="display: block; margin-top: 1em;"></textarea>
  <p style="font-size: 0.8em; color: gray;">
    ※セーブデータは直接ファイルとして保存されません。上記のテキストエリアに表示されたデータをコピーして、テキストファイルに貼り付けて保存してください。<br>
    ロードする際は、保存したデータを上記のテキストエリアに貼り付けてから「ロード」ボタンを押してください。
  </p>
</div>

<details>
  <summary>Ver.4.6.6リリースノート</summary><p>
    <div style="margin-top: 1em; border: 1px solid #ccc; padding: 10px; background-color: #f9f9f9;">
重要！　更新以前からプレイしていた人は一度手動でセーブ、ロードしてください！</br>
[見た目]計画キューの可視化、撤回を可能にする</br>
[見た目]陸地面積の可視化(目安)</br>
[機能]「オプションを先頭に戻さない」チェックボックスの追加</br>
[機能]計画キューに最大20件保存可能になる(実行数は変わらず)</br>
[機能]「遅延行動」計画の実装</br>
[修正]農場/工場建設と設備強化を同時に行うときに失敗しなくなる</br>
[修正]整地と防衛施設建設を同時に行うときに失敗しなくなる</br>
[追加]海を掘削すると低確率で油田が発掘され、収入が増える</br>
[追加]掘削時、発掘の確率を指定して油田発掘率を上げられる</br>
[追加]油田にも設備強化が可能になる(枯渇率は上がる)</br>
[追加]災害「隆起」：山の発生</br>
[追加]災害「噴火」：上級な島は一定期間　食料産出停止, 人口増加停止</br>
[追加]災害「経済危機」：上級な島は一定期間　一部資金凍結, 資金算出激減, 維持費激増</br>
[追加]災害「地震/津波」：上級な島で稀に発生し、広範囲が破壊される</br>
    </div>
</p></details>
<p>陸地面積: <span id="landArea">0</span>Km² | 砲撃可能数上限: <span id="gunCount">0</span>回 | 実績Pt: <span id="achievementPoints">0</span>Pt</br>資金: <span id="money">1000</span>G | 食料: <span id="food">500</span> | 人口: <span id="population">0</span>人 | ターン: <span id="turn">0</span> | 島の名前: <span id="currentIslandName"></span></p>
<div>
    <label for="otherIslandActionInput">他島の行動:</label>
    <input type="text" id="otherIslandActionInput" style="width: 400px; margin-bottom: 5px;" placeholder="ここに他島からの行動を入力してください">
</div>
<div>
    <label for="actionForOtherIslandOutput">他島への行動:</label>
    <input type="text" id="actionForOtherIslandOutput" style="width: 400px; margin-bottom: 5px;" readonly>
</div>
<div style="margin-top: 2px;">
    <input type="checkbox" id="keepOptionSelected">
    <label for="keepOptionSelected">オプションを先頭に戻さない</label>
</div>
<button onclick="nextTurn()">▶ ターンを進める</button>
<br>
<select id="actionSelect" onchange="updateConfirmButton()">
  <option value="">計画一覧</option>
  <option value="buildFarm" data-myisland="true">農場建設 (100G)</option>
  <option value="buildFactory" data-myisland="true">工場建設 (100G)</option>
  <option value="enhanceFacility" data-myisland="true">設備強化 (10000G)</option>
  <option value="buildPort" data-myisland="true">港建設 (3000G)</option>
  <option value="buildGun" data-myisland="true">砲台建設 (1200G)</option>
  <option value="buildDefenseFacility" data-myisland="true">防衛施設建設 (5000G)</option>
  <option value="flatten" data-myisland="true">整地 (20G)</option>
  <option value="landfill" data-myisland="true">埋め立て (600G)</option>
  <option value="dig" data-myisland="true">掘削 (300G)</option>
  <option value="cutForest" data-myisland="true">伐採 (無料)</option>
  <option value="plantForest" data-myisland="true">植林 (200G)</option>
  <option value="exportFood" data-myisland="true">食料輸出 (食料20)</option>
  <option value="bombard" data-anyisland="true">砲撃 (120G)</option>
  <option value="spreadBombard" data-anyisland="true">拡散弾砲撃 (500G)</option>
  <option value="ppBombard" data-anyisland="true">PP弾砲撃 (10000000G)</option>
  <option value="selfDestructMilitaryFacility" data-myisland="true">軍事施設自爆 (無料)</option>
  <option value="goToOtherIsland" data-myisland="true">他の島に行く</option>
  <option value="returnToMyIsland" data-anyisland="true">自島に戻る</option>
  <option value="delayAction" data-myisland="true">遅延行動</option>
  <option value="buildWarship" data-myisland="true">軍艦建造</option>
  <option value="warshipTool" data-myisland="true">軍艦ツール</option>
  <option value="buildMonument" data-myisland="true">石碑建設 (500000000G)</option>
  <option value="upgradeMonument" data-myisland="true">石碑強化 (500000000G)</option>
  <option value="sellMonument" data-myisland="true">石碑売却 (無料)</option>
  <option value="initializeIsland" data-myisland="true">島の初期化</option>
</select><select id="warshipSubSelect" onchange="updateConfirmButton()" style="width: 140px; display: none;">
  <option value="">軍艦ツールを選択</option>
  <option value="refuelWarship" data-myisland="true">燃料補給</option>
  <option value="resupplyWarshipAmmo" data-myisland="true">弾薬補給</option>
  <option value="repairWarship" data-myisland="true">軍艦修理</option>
  <option value="enhanceWarship" data-myisland="true">軍艦増強</option>
  <option value="decommissionWarship" data-myisland="true">軍艦除籍</option>
  <option value="dispatchWarship" data-myisland="true">軍艦派遣</option>
  <option value="requestWarshipReturn" data-myisland="true">軍艦帰還要請</option>
</select>
<input type="number" id="exportAmount" placeholder="輸出数" min="1" style="width: 60px; display: none;">
<input type="number" id="bombardCount" placeholder="攻撃数" min="1" style="width: 60px; display: none;">
<input type="number" id="refuelAmount" placeholder="補給数" min="1" style="width: 60px; display: none;">
<input type="number" id="resupplyAmmoAmount" placeholder="補給数" min="1" style="width: 60px; display: none;">
<input type="number" id="repairAmount" placeholder="回復耐久値" min="1" style="width: 90px; display: none;">
<input type="number" id="oilDrillFactor" placeholder="発掘率(任意)" min="1" max="10" value="" style="width: 90px; display: none;">
<input type="text" id="touristCodeInput" placeholder="観光者コードを入力" style="width: 250px; display: none;">
<div id="warshipBuildInputs">
    <h3>軍艦建造パラメータ</h3>
    <div>
        <label for="warshipName">艦名:</label>
        <input type="text" id="warshipName" maxlength="15" value="無銘艦">
    </div>
    <div>
        <label for="warshipDurability">耐久度:</label>
        <input type="number" id="warshipDurability" min="2" max="15" value="2"> (2～15, 1あたり10,000,000G)
    </div>
    <div>
        <label for="warshipMainGun">主砲:</label>
        <input type="number" id="warshipMainGun" min="1" max="5" value="1"> (1～5, 1あたり12,000,000G)
    </div>
    <div>
        <label for="warshipTorpedo">魚雷:</label>
        <input type="number" id="warshipTorpedo" min="0" max="3" value="0"> (0～3, 1あたり10,000,000G)
    </div>
    <div>
        <label for="warshipAntiAir">対空砲:</label>
        <input type="number" id="warshipAntiAir" min="1" max="6" value="1"> (1～6, 1あたり5,000,000G)
    </div>
    <div>
        <label for="warshipAmmo">弾薬庫:</label>
        <input type="number" id="warshipAmmo" min="10" max="500" value="10"> (10～500, 1あたり100,000G)
    </div>
    <div>
        <label for="warshipRecon">偵察機:</label>
        <input type="number" id="warshipRecon" min="0" max="2" value="0"> (0～2, 1あたり12,500,000G)
    </div>
    <div>
        <label for="warshipAccuracy">射撃精度向上:</label>
        <input type="number" id="warshipAccuracy" min="0" max="2" value="0"> (0～2, 1あたり50,000,000G)
    </div>
</div>
<button onclick="confirmAction()" id="confirmBtn" disabled>決定</button>
<span id="tileInfo"></span>
<div id="gameContainer" style="display: flex; gap: 5px;">
    <table id="map"></table>
    <div id="actionQueueDisplay" style="font-size: 0.7em;margin-top: 1em; border: 1px solid #ccc; padding: 10px; background-color: #f9f9f9;">
      <h4>計画キュー</h4><ul id="actionQueueList" style="list-style-type: none; padding: 0;"></ul>設定した計画はクリックで撤回可能です。
    </div>
</div>
<div id="log" style="margin-top:1em;"></div>
<script src="script.js"></script>
<noscript>
  <div style="color: red; padding: 20px; border: 1px solid red;">
    <p>お使いのブラウザではJavaScriptが無効になっているか、サポートされていません。</p>
    <p>サイトを正しく表示するために、設定からJavaScriptを有効にしてください。</p>
  </div>
</noscript>
</body></html>
